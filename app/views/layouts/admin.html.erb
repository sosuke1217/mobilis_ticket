<!DOCTYPE html>
<html>
<head>
  <title>管理画面</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= stylesheet_link_tag    "application", media: "all" %>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <%= javascript_importmap_tags %>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <header>
    <h1>管理ダッシュボード</h1>
    <!-- ログアウトボタン - JavaScript版 -->
    <button type="button" class="btn btn-outline-danger" onclick="logout()">ログアウト</button>
  </header>
  <main>
    <%= yield %>
  </main>
  
  <script>
    function logout() {
      if (confirm('本当にログアウトしますか？')) {
        // CSRFトークンを取得
        const token = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
        
        // フォームを作成して送信
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '<%= destroy_admin_user_session_path %>';
        form.style.display = 'none';
        
        // _method フィールドを追加（DELETE）
        const methodField = document.createElement('input');
        methodField.type = 'hidden';
        methodField.name = '_method';
        methodField.value = 'delete';
        form.appendChild(methodField);
        
        // CSRFトークンを追加
        const csrfField = document.createElement('input');
        csrfField.type = 'hidden';
        csrfField.name = 'authenticity_token';
        csrfField.value = token;
        form.appendChild(csrfField);
        
        // フォームを送信
        document.body.appendChild(form);
        form.submit();
      }
    }
  </script>
</body>
</html>