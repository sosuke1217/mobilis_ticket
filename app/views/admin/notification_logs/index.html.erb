<div class="container my-4">
  <h1 class="mb-4">ÈÄöÁü•Â±•Ê≠¥‰∏ÄË¶ß</h1>

  <!-- üîç Ê§úÁ¥¢„Éï„Ç©„Éº„É† -->
  <%= search_form_for @q, url: admin_notification_logs_path, method: :get, html: { class: "row g-3 align-items-end mb-4" } do |f| %>
    <div class="col-md-4">
      <%= f.label :user_name_cont, "„É¶„Éº„Ç∂„ÉºÂêç", class: "form-label" %>
      <%= f.text_field :user_name_cont, class: "form-control", placeholder: "‰æã: ÂêâÁî∞Â£ÆÁ•ê" %>
    </div>
    <div class="col-md-4">
      <%= f.label :kind_eq, "Á®ÆÂà•", class: "form-label" %>
      <%= f.select :kind_eq, NotificationLog.distinct.pluck(:kind), include_blank: "ÂÖ®„Å¶", class: "form-select" %>
    </div>
    <div class="col-md-auto">
      <%= f.submit "Ê§úÁ¥¢", class: "btn btn-primary" %>
      <%= link_to "„É™„Çª„ÉÉ„Éà", admin_notification_logs_path, class: "btn btn-outline-secondary ms-2" %>
    </div>
  <% end %>

  <!-- üìã ÈÄöÁü•Â±•Ê≠¥„ÉÜ„Éº„Éñ„É´ -->
  <% if @notification_logs.any? %>
    <table class="table table-bordered table-hover">
      <thead class="table-dark">
        <tr>
          <th><%= sort_link(@q, :sent_at, "ÈÄÅ‰ø°Êó•ÊôÇ") %></th>
          <th><%= sort_link(@q, 'user.name', "„É¶„Éº„Ç∂„Éº") %></th>
          <th><%= sort_link(@q, 'ticket.title', "„ÉÅ„Ç±„ÉÉ„ÉàÂêç") %></th>
          <th><%= sort_link(@q, :kind, "Á®ÆÂà•") %></th>
          <th>„É°„ÉÉ„Çª„Éº„Ç∏</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @notification_logs.each do |log| %>
          <tr>
            <td><%= l(log.sent_at, format: :short) %></td>
            <td>
              <%= link_to(log.user&.name.presence || log.user&.line_user_id || "‰∏çÊòé", admin_user_path(log.user), class: "text-decoration-none") if log.user.present? %>
            </td>
            <td><%= log.ticket&.title || "‰∏çÊòé" %></td>
            <td><%= log.kind %></td>
            <td><%= simple_format(log.message) %></td>
            <td>
              <%= button_to "ÂâäÈô§", admin_notification_log_path(log),
                    method: :delete,
                    data: { confirm: "„Åì„ÅÆÈÄöÁü•„É≠„Ç∞„ÇíÂâäÈô§„Åó„Å¶„ÇÇ„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü" },
                    class: "btn btn-sm btn-outline-danger" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p class="text-muted">ÈÄöÁü•Â±•Ê≠¥„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
  <% end %>

  <div class="mt-3">
    <%= paginate @notification_logs %>
  </div>
</div>
