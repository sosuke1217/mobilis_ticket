<!-- app/views/admin/settings/show.html.erb -->

<div class="container-lg my-4">
  <!-- ヘッダー -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h2">⚙️ システム設定</h1>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><%= link_to "管理画面", admin_root_path %></li>
        <li class="breadcrumb-item active">システム設定</li>
      </ol>
    </nav>
  </div>

  <!-- アクションボタン -->
  <div class="mb-4">
    <div class="btn-group" role="group">
      <%= link_to "✏️ 設定を編集", edit_admin_settings_path, class: "btn btn-primary" %>
      <%= link_to "📊 システム情報", admin_settings_system_info_path, class: "btn btn-info" %>
      <%= link_to "📤 設定をエクスポート", admin_settings_export_path(format: :json), class: "btn btn-secondary" %>
      <%= link_to "🔄 デフォルトにリセット", admin_settings_reset_path, 
          class: "btn btn-warning", 
          data: { 
            confirm: "設定をデフォルト値にリセットしますか？この操作は元に戻せません。",
            method: :patch
          } %>
    </div>
  </div>

  <div class="row">
    <!-- 予約設定 -->
    <div class="col-md-6">
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">🕐 予約時間設定</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12">
              <div class="mb-3">
                <label class="form-label text-muted">📏 予約間インターバル</label>
                <div class="d-flex align-items-center">
                  <span class="badge bg-success fs-6 me-2"><%= @setting.reservation_interval_minutes %></span>
                  <span class="text-muted">分</span>
                </div>
                <small class="text-muted">前の予約終了から次の予約開始までの準備時間</small>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-6">
              <div class="mb-3">
                <label class="form-label text-muted">🌅 営業開始</label>
                <div class="fs-5 fw-bold text-primary"><%= @setting.business_hours_start %>:00</div>
              </div>
            </div>
            <div class="col-6">
              <div class="mb-3">
                <label class="form-label text-muted">🌆 営業終了</label>
                <div class="fs-5 fw-bold text-primary"><%= @setting.business_hours_end %>:00</div>
              </div>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label text-muted">⏱️ 予約スロット間隔</label>
            <div class="d-flex align-items-center">
              <span class="badge bg-info fs-6 me-2"><%= @setting.slot_interval_minutes %></span>
              <span class="text-muted">分刻み</span>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label text-muted">🔒 休業日</label>
            <div>
              <% if @setting.sunday_closed? %>
                <span class="badge bg-secondary">日曜日</span>
              <% else %>
                <span class="text-muted">なし</span>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 予約制限設定 -->
    <div class="col-md-6">
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-warning text-dark">
          <h5 class="mb-0">⚠️ 予約制限設定</h5>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label text-muted">📅 最大予約可能期間</label>
            <div class="d-flex align-items-center">
              <span class="badge bg-primary fs-6 me-2"><%= @setting.max_advance_booking_days %></span>
              <span class="text-muted">日先まで</span>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label text-muted">⏰ 最低予約時間</label>
            <div class="d-flex align-items-center">
              <span class="badge bg-warning fs-6 me-2"><%= @setting.min_advance_booking_hours %></span>
              <span class="text-muted">時間前まで</span>
            </div>
            <small class="text-muted">※管理者による予約作成時は制限なし</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 設定プレビュー -->
  <div class="card shadow-sm">
    <div class="card-header bg-info text-white">
      <h5 class="mb-0">📊 現在の設定プレビュー</h5>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <h6 class="text-primary">⏰ 営業時間・予約設定</h6>
          <ul class="list-unstyled">
            <li><strong>営業時間:</strong> <%= @setting.business_hours_range %></li>
            <li><strong>予約スロット:</strong> <%= @setting.slot_interval_minutes %>分刻み</li>
            <li><strong>予約間隔:</strong> <%= @setting.reservation_interval_minutes %>分のインターバル</li>
            <li><strong>休業日:</strong> <%= @setting.sunday_closed? ? "日曜日" : "なし" %></li>
          </ul>
        </div>
        <div class="col-md-6">
          <h6 class="text-warning">🚫 予約制限</h6>
          <ul class="list-unstyled">
            <li><strong>予約可能期間:</strong> 最大<%= @setting.max_advance_booking_days %>日先まで</li>
            <li><strong>最低予約時間:</strong> <%= @setting.min_advance_booking_hours %>時間前まで</li>
          </ul>
          
          <h6 class="text-success mt-3">📝 実際の例</h6>
          <div class="alert alert-light">
            <small>
              <strong>13:00-14:00の予約後:</strong><br>
              • 14:00-14:<%= @setting.reservation_interval_minutes.to_s.rjust(2, '0') %>は準備時間（予約不可）<br>
              • 14:<%= @setting.reservation_interval_minutes.to_s.rjust(2, '0') %>以降から次の予約が可能<br>
              • 最大<%= @setting.max_advance_booking_days %>日先まで予約受付
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 最終更新情報 -->
  <div class="mt-4">
    <div class="alert alert-secondary">
      <small>
        <i class="fas fa-clock me-1"></i>
        最終更新: <%= @setting.updated_at.strftime('%Y年%m月%d日 %H:%M') %>
        <span class="ms-3">
          <i class="fas fa-calendar me-1"></i>
          作成日: <%= @setting.created_at.strftime('%Y年%m月%d日') %>
        </span>
      </small>
    </div>
  </div>
</div>

<style>
.card {
  transition: box-shadow 0.15s ease-in-out;
}

.card:hover {
  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
}

.badge {
  font-size: 0.875rem;
}

.alert-light {
  background-color: #f8f9fa;
  border: 1px solid #dee2e6;
}

.text-primary { color: #0d6efd !important; }
.text-warning { color: #fd7e14 !important; }
.text-success { color: #198754 !important; }
</style>